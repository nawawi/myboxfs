#!/bin/php
<?
//
// Mybox Firewall - A Firewall Appliance
// http://www.mybox.net.my/
//
// (C) Copyright 2002,2003,2004 Mohd Nawawi Mohamad Jamili, TraceNetwork Corporation Sdn. Bhd.
//
// This program is not free software; you cannot redistribute it and/or
// modify without permission copyright owner.
//
// This code is protected by copyright law and international treaties. 
// Unauthorized reproduction or distribution of this program, or any portion of it, 
// may result in severe civil and criminal penalties, and will be prosecuted to the 
// maximum extent possible under the law.
//
// $Id: png.so,v 1.05 2003/12/05 9:58 PM nawawi Exp $
//

	if(isset($nocache)&& $nocache==1) {
		header("Cache-Control: no-store, no-cache");
		header("Pragma: no-cache");
	} else {
		header("Cache-Control: store, cache");
		header("Pragma: cache");
	}

	if((isset($path)&& $path!='' && isset($image)&& $image!='') && (file_exists("$path/$image"))) {
		list($pic,$ext)=preg_split("/\./",$image);
		if(isset($ext)&& $ext=='gif') {
			header("Content-type: image/gif");
		} else {
			header("Content-type: image/png");
		} 
		$fn=fopen("$path/$image","r");
		fpassthru($fn);
		fclose($fn);
	} else {
		header("Content-type: image/png");
		$fn=fopen("image/noimage.png","r");
		fpassthru($fn);
		fclose($fn);
	}
 	flush();
?>