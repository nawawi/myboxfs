alert tcp any any -> $HOME_NET 139 (msg:"1\:1 MS-SQL/SMB xp_enumresultset possible buffer overflow"; content: "x|00|p|00|_|00|e|00|n|00|u|00|m|00|r|00|e|00|s|00|u|00|l|00|t|00|s|00|e|00|t|00|"; nocase; flow:to_server,established; offset:32;)
alert tcp any any -> $HOME_NET 139 (msg:"1\:1 MS-SQL/SMB raiserror possible buffer overflow"; content:"r|00|a|00|i|00|s|00|e|00|r|00|r|00|o|00|r|00|"; nocase; flow:to_server,established; offset: 32;)
alert tcp any any -> $HOME_NET 139 (msg:"1\:1 MS-SQL/SMB xp_displayparamstmt possible buffer overflow"; content: "x|00|p|00|_|00|d|00|i|00|s|00|p|00|l|00|a|00|y|00|p|00|a|00|r|00|a|00|m|00|s|00|t|00|m|00|t|00|"; nocase; flow:to_server,established; offset:32;)
alert tcp any any -> $HOME_NET 139 (msg:"1\:1 MS-SQL/SMB xp_setsqlsecurity possible buffer overflow"; content: "x|00|p|00|_|00|s|00|e|00|t|00|s|00|q|00|l|00|s|00|e|00|c|00|u|00|r|00|i|00|t|00|y|00|"; nocase; flow:to_server,established; offset:32;)
alert tcp any any -> $HOME_NET 139 (msg:"1\:1 MS-SQL/SMB xp_printstatements possible buffer overflow"; content: "x|00|p|00|_|00|p|00|r|00|i|00|n|00|t|00|s|00|t|00|a|00|t|00|e|00|m|00|e|00|n|00|t|00|s|00|"; nocase; flow:to_server,established; offset:32;)
alert tcp any any -> $HOME_NET 139 (msg:"1\:1 MS-SQL/SMB xp_sprintf possible buffer overflow"; content: "x|00|p|00|_|00|s|00|p|00|r|00|i|00|n|00|t|00|f|00|"; nocase; flow:to_server,established; offset: 32;)
alert tcp any any -> $HOME_NET 139 (msg:"1\:1 MS-SQL/SMB xp_showcolv possible buffer overflow"; content: "x|00|p|00|_|00|s|00|h|00|o|00|w|00|c|00|o|00|l|00|v|00|"; nocase; flow:to_server,established; offset:32;)
alert tcp any any -> $HOME_NET 139 (msg:"1\:1 MS-SQL/SMB xp_peekqueue possible buffer overflow"; content: "x|00|p|00|_|00|p|00|e|00|e|00|k|00|q|00|u|00|e|00|u|00|e|00|"; nocase; flow:to_server,established; offset:32;)
alert tcp any any -> $HOME_NET 139 (msg:"1\:1 MS-SQL/SMB xp_proxiedmetadata possible buffer overflow"; content: "x|00|p|00|_|00|p|00|r|00|o|00|x|00|i|00|e|00|d|00|m|00|e|00|t|00|a|00|d|00|a|00|t|00|a|00|"; nocase; flow:to_server,established; offset:32;)
alert tcp any any -> $HOME_NET 139 (msg:"1\:1 MS-SQL/SMB xp_updatecolvbm possible buffer overflow"; content: "x|00|p|00|_|00|u|00|p|00|d|00|a|00|t|00|e|00|c|00|o|00|l|00|v|00|b|00|m|00|"; nocase; flow:to_server,established; offset:32;)
alert tcp any any -> $HOME_NET 1433 (msg:"1\:1 MS-SQL xp_displayparamstmt possible buffer overflow"; content: "x|00|p|00|_|00|d|00|i|00|s|00|p|00|l|00|a|00|y|00|p|00|a|00|r|00|a|00|m|00|s|00|t|00|m|00|t"; nocase; flow:to_server,established;)
alert tcp any any -> $HOME_NET 1433 (msg:"1\:1 MS-SQL xp_setsqlsecurity possible buffer overflow"; content: "x|00|p|00|_|00|s|00|e|00|t|00|s|00|q|00|l|00|s|00|e|00|c|00|u|00|r|00|i|00|t|00|y|00|"; nocase; flow:to_server,established;)
alert tcp any any -> $HOME_NET 1433 (msg:"1\:1 MS-SQL xp_enumresultset possible buffer overflow"; content: "x|00|p|00|_|00|e|00|n|00|u|00|m|00|r|00|e|00|s|00|u|00|l|00|t|00|s|00|e|00|t|00|"; nocase; flow:to_server,established;)
alert tcp any any -> $HOME_NET 1433 (msg:"1\:1 MS-SQL shellcode attempt"; content: "|3920d0009201c200520055003920ec00|"; flow:to_server,established;)
alert tcp any any -> $HOME_NET 1433 (msg:"1\:1 MS-SQL shellcode attempt"; content: "|4800250078007700900090009000900090003300c000500068002e00|"; flow:to_server,established;)
alert tcp any any -> $HOME_NET 1433 (msg:"1\:1 MS-SQL xp_printstatements possible buffer overflow"; content: "x|00|p|00|_|00|p|00|r|00|i|00|n|00|t|00|s|00|t|00|a|00|t|00|e|00|m|00|e|00|n|00|t|00|s|00|"; nocase; flow:to_server,established;)
alert tcp any any -> $HOME_NET 1433 (msg:"1\:1 MS-SQL xp_updatecolvbm possible buffer overflow"; content: "x|00|p|00|_|00|u|00|p|00|d|00|a|00|t|00|e|00|c|00|o|00|l|00|v|00|b|00|m|00|"; nocase; flow:to_server,established;)
alert tcp any any -> $HOME_NET 1433 (msg:"1\:1 MS-SQL xp_sprintf possible buffer overflow"; content: "x|00|p|00|_|00|s|00|p|00|r|00|i|00|n|00|t|00|f|00|"; nocase; flow:to_server,established;)
alert tcp any any -> $HOME_NET 1433 (msg:"1\:1 MS-SQL xp_showcolv possible buffer overflow"; content: "x|00|p|00|_|00|s|00|h|00|o|00|w|00|c|00|o|00|l|00|v|00|"; nocase; flow:to_server,established;)
alert tcp any any -> $HOME_NET 1433 (msg:"1\:1 MS-SQL xp_peekqueue possible buffer overflow"; content: "x|00|p|00|_|00|p|00|e|00|e|00|k|00|q|00|u|00|e|00|u|00|e|00|"; nocase; flow:to_server,established;)
alert tcp any any -> $HOME_NET 1433 (msg:"1\:1 MS-SQL xp_proxiedmetadata possible buffer overflow"; content: "x|00|p|00|_|00|p|00|r|00|o|00|x|00|i|00|e|00|d|00|m|00|e|00|t|00|a|00|d|00|a|00|t|00|a|00|"; nocase; flow:to_server,established;)
alert tcp any any -> $HOME_NET 1433 (msg:"1\:1 MS-SQL raiserror possible buffer overflow"; content:"r|00|a|00|i|00|s|00|e|00|r|00|r|00|o|00|r|00|"; nocase; flow:to_server,established;)
alert tcp any 1433 -> $HOME_NET any (msg:"1\:1 MS-SQL sa login failed"; content: "Login failed for user |27|sa|27|"; flow:from_server,established;)
alert udp any any -> $HOME_NET 1434 (msg:"1\:1 MS-SQL Worm propagation attempt"; content:"|04|"; depth:1; content:"|81 F1 03 01 04 9B 81 F1 01|"; content:"sock"; content:"send";)
alert udp any any -> $HOME_NET 1434 (msg:"1\:1 MS-SQL Worm propagation attempt OUTBOUND"; content:"|04|"; depth:1; content:"|81 F1 03 01 04 9B 81 F1|"; content:"sock"; content:"send";)
alert udp any any -> $HOME_NET 1434 (msg:"1\:1 MS-SQL version overflow attempt"; content:"|04|"; offset:0; depth:1; dsize:>100;)
